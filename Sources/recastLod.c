/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   recast.c                                           :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: acaillea <acaillea@student.42.fr>          +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2022/10/13 10:44:20 by acaillea          #+#    #+#             */
/*   Updated: 2022/10/13 13:24:50 by acaillea         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "../Includes/main.h"

#define mapW 24
#define mapH 24

int worldMap[mapW][mapH]=
{
  {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,2,2,2,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,3,0,0,0,3,0,0,0,1},
  {1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,0,0,0,5,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
  {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
};

void	window_init(t_global *d)
{
	d->mlx = mlx_init();
	if(!d->mlx)
		return ;
	d->mlx_win = mlx_new_window(d->mlx, W, H, "cub3D");
	if(!d->mlx_win)
		return ;
	d->img = mlx_new_image(d->mlx, W, H);
	if (!d->img)
		return ;
	d->addr = mlx_get_data_addr(d->img, &d->bpp, &d->line_len, &d->endian);
	if (!d->addr)
		return ;
	// mlx_hook(d->mlx_win, 2, (1L << 0), &key_hook, d);
	// mlx_mouse_hook(d->mlx_win, &mouse_hook, d);
	mlx_loop(d->mlx);
}

int main(void)
{
	t_global	*d;

	d = (t_global *)malloc(sizeof(t_global));
	d->player = (t_player *)malloc(sizeof(t_player));
	if(!d || !d->player)
		return(0);
	//-----------------------------------------------
	d->player->posX = 22;
	d->player->posY = 12;
	d->player->screenX = 0;
	d->player->screenY = 0.66;
	d->player->pDirX = -1;
	d->player->pDirY = 0;


	//------------------------------------------------
	// double	time = 0;
	// double	oldTime = 0;
	double	camX;
	int 	x = -1;
	double	rayDirX;
	double	rayDirY;
	
	
	//------------------------------------------------
	window_init(d);
	while(19)
	{
		while (++x < W)
		{
			camX = (2 * x) / (W - 1);
			rayDirX = d->player->pDirX + (d->player->screenX * camX);
			rayDirY = d->player->pDirY + (d->player->screenY * camX);
		}
	}
	free(d->player);
	free(d);
	return(0);
}